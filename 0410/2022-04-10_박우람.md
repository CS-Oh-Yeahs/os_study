# os_study 

# ğŸ—³ï¸Â Memory Management

## 1. Noncontiguous allocation(ë¶ˆì—°ì†í• ë‹¹)

> ë¶ˆì—°ì†í• ë‹¹(noncontiguous allocation) ê¸°ë²•ì´ë€ í•˜ë‚˜ì˜ í”„ë¡œì„¸ìŠ¤ê°€ ë¬¼ë¦¬ì  ë©”ëª¨ë¦¬ì˜ ì—¬ëŸ¬ ìœ„ì¹˜ì— ë¶„ì‚°ë˜ì–´ ì˜¬ë¼ê°ˆ ìˆ˜ ìˆëŠ” ë©”ëª¨ë¦¬ í• ë‹¹ ê¸°ë²•ì„ ë§í•œë‹¤. ë¶ˆì—°ì†í• ë‹¹ ë°©ì‹ì—ëŠ” í•˜ë‚˜ì˜ í”„ë¡œê·¸ë¨ì„ ë¶„í• í•˜ëŠ” ê¸°ì¤€ì— ë”°ë¼ ë™ì¼í•œ í¬ê¸°ë¡œ ë‚˜ëˆ„ì–´ ë©”ëª¨ë¦¬ì— ì˜¬ë¦¬ëŠ” í˜ì´ì§• ê¸°ë²•ê³¼, í¬ê¸°ëŠ” ì¼ì •í•˜ì§€ ì•Šì§€ë§Œ ì˜ë¯¸ ë‹¨ìœ„(ì½”ë“œ, ë°ì´í„°, ìŠ¤íƒ ì˜ì—­)ë¡œ ë‚˜ëˆ„ì–´ ë©”ëª¨ë¦¬ì— ì˜¬ë¦¬ëŠ” ì„¸ê·¸ë©˜í…Œì´ì…˜ ê¸°ë²•, ê·¸ë¦¬ê³  ì„¸ê·¸ë¨¼í…Œì´ì…˜ì„ ê¸°ë³¸ìœ¼ë¡œ í•˜ë˜ ì´ë¥¼ ë‹¤ì‹œ ë™ì¼ í¬ê¸°ì˜ í˜ì´ì§€ë¡œ ë‚˜ëˆ„ì–´ ë©”ëª¨ë¦¬ì— ì˜¬ë¦¬ëŠ” í˜ì´ì§€ë“œ ì„¸ê·¸ë¨¼í…Œì´ì…˜ ê¸°ë²• ë“±ì´ ìˆë‹¤.
> 

### 1.1 Paging

> í˜ì´ì§• ê¸°ë²•ì€ í”„ë¡œì„¸ìŠ¤ì˜ ê°€ìƒ ë©”ëª¨ë¦¬ë¥¼ ë™ì¼í•œ í¬ê¸°ì˜ Pageë¡œ ì˜ë¼ì„œ ê° Page ë³„ë¡œ ë¹„ì–´ìˆëŠ” ë¬¼ë¦¬ì  ë©”ëª¨ë¦¬ì— ì €ì¥í•˜ëŠ” ë°©ì‹ì„ ë§í•œë‹¤. í˜ì´ì§• ê¸°ë²•ì—ì„œëŠ” ê° í”„ë¡œì„¸ìŠ¤ì˜ ì£¼ì†Œ ê³µê°„ ì „ì²´ë¥¼ ë¬¼ë¦¬ì  ë©”ëª¨ë¦¬ì— í•œë²ˆì— ì˜¬ë¦´ í•„ìš”ì—†ì´ ì¼ë¶€ëŠ” ë°±í‚¹ìŠ¤í† ì–´, ì¼ë¶€ëŠ” ë¬¼ë¦¬ì  ë©”ëª¨ë¦¬ì— í˜¼ì¬ ì‹œí‚¤ëŠ” ê²ƒì´ ê°€ëŠ¥í•˜ë‹¤.
> 
> 
> í˜ì´ì§• ê¸°ë²•ì—ì„œëŠ” ë¬¼ë¦¬ì  ë©”ëª¨ë¦¬ë¥¼ í˜ì´ì§€ í¬ê¸°ì™€ ë™ì¼í•œ í”„ë ˆì„ìœ¼ë¡œ ë‚˜ëˆ„ì–´ë‘ê¸° ë•Œë¬¸ì— ì•ì„œ ì„¤ëª…í•œ ë™ì  ë©”ëª¨ë¦¬ í• ë‹¹ ë¬¸ì œê°€ ë°œìƒí•˜ì§€ ì•ŠëŠ”ë‹¤. ë¹„ì–´ìˆëŠ” ê³µê°„ì´ ëª¨ë‘ ë™ì¼í•œ í¬ê¸°ì—¬ì„œ ì–´ë– í•œ ìœ„ì¹˜ì—ë„ ì €ì¥í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì´ë‹¤. í•˜ì§€ë§Œ ì´ëŸ¬í•œ íŠ¹ì§•ì€ ë³µì¡í•œ ì£¼ì†Œë³€í™˜ ì ˆì°¨ë¥¼ í•„ìš”ë¡œ í•œë‹¤. 
> 

âœ”ï¸Â **í•˜ë‚˜ì˜ Pageì˜ í¬ê¸°ëŠ” 4KB**

âœ”ï¸Â  **Paging ê¸°ë²•ì„ ì‚¬ìš©í•  ê²½ìš° í•´ë‹¹ pageì˜ **page table ì£¼ì†Œì™€ ë…¼ë¦¬ì  ì£¼ì†Œë¥¼ ë¬¼ë¦¬ì  ë©”ëª¨ë¦¬ì˜ ì£¼ì†Œë¡œ ë³€í™˜í•œë‹¤.**

1ï¸âƒ£Â  **Paging ê¸°ë²•ì˜ ì£¼ì†Œë³€í™˜ ì ˆì°¨ëŠ” ì–´ë–»ê²Œ ì´ë¤„ì§€ë‚˜?**

í˜ì´ì§• ê¸°ë²•ì€ ì£¼ì†Œ ë³€í™˜ì´ í˜ì´ì§€ ë‹¨ìœ„ë¡œ ì´ë¤„ì ¸ì•¼ í•˜ê¸° ë•Œë¬¸ì— ì¡°ê¸ˆ ë” ë³µì¡í•œ ì£¼ì†Œë³€í™˜ ì ˆì°¨ê°€ í•„ìš”í•˜ë‹¤. ë”°ë¼ì„œ í˜ì´ì§• ê¸°ë²•ì—ì„œëŠ” ê°ê°ì˜ ì£¼ì†Œ ë³€í™˜ì„ ìœ„í•œ í˜ì´ì§€ í…Œì´ë¸”ì„ ê°€ì§„ë‹¤. í˜ì´ì§€ í…Œì´ë¸”ì€ í”„ë¡œì„¸ìŠ¤ê°€ ê°€ì§ˆ ìˆ˜ ìˆëŠ” í˜ì´ì§€ì˜ ê°œìˆ˜ë§Œí¼ ì£¼ì†Œ ë³€í™˜ ì—”íŠ¸ë¦¬ë¥¼ ê°€ì§€ê³  ìˆìœ¼ë©°, ì—”íŠ¸ë¦¬ëŠ” í˜ì´ì§€ ë²ˆí˜¸ì™€ í˜ì´ì§€ ì˜¤í”„ì…‹ìœ¼ë¡œ ì´ë£¨ì–´ì ¸ ìˆë‹¤. ì¶”ê°€ë¡œ í˜ì´ì§€ í…Œì´ë¸”ì€ í”„ë¡œì„¸ìŠ¤ì˜ í˜ì´ì§€ ìˆ˜ ë§Œí¼ ì—”íŠ¸ë¦¬ê°€ ìƒì„±ë˜ê¸° ë•Œë¬¸ì— í° ìš©ëŸ‰ì´ í•„ìš”í•˜ì—¬ ë©”ì¸ ë©”ëª¨ë¦¬ì— ì €ì¥ëœë‹¤.

### 1.2 **Page Table**

> í˜ì´ì§€ í…Œì´ë¸”ì´ë€ Pageì˜ ë¬¼ë¦¬ì  ë©”ëª¨ë¦¬ ì£¼ì†Œ ë³€í™˜ì„ í•˜ê¸° ìœ„í•œ ìë£Œêµ¬ì¡°ì´ë‹¤. í˜ì´ì§€ ê°¯ìˆ˜ë§Œí¼ ì—”íŠ¸ë¦¬ê°€ ìƒì„±ë˜ê¸° ë•Œë¬¸ì— ë§ì€ ìš©ëŸ‰ì„ í•„ìš”ë¡œ í•˜ì—¬ ë©”ì¸ ë©”ëª¨ë¦¬ì— ì €ì¥ëœë‹¤. CPUê°€ ë¬¼ë¦¬ì  ì£¼ì†Œì— ì ‘ê·¼í•˜ë ¤ë©´ Page tableì„ ê±°ì³ì„œ Page Frame ê¹Œì§€ ë„ë‹¬í•´ì•¼ í•˜ëŠ”ë°, ë‘˜ ë‹¤ ë©”ì¸ ë©”ëª¨ë¦¬ì— ì €ì¥ë˜ì–´ ìˆê¸° ë•Œë¬¸ì— ë©”ëª¨ë¦¬ì— ë‘ ë²ˆ ì ‘ê·¼í•˜ê²Œ ë˜ëŠ” ì˜¤ë²„í—¤ë“œê°€ ë°œìƒí•œë‹¤. Page tableì˜ ë¬¸ì œì ì„ í•´ê²°í•˜ê¸° ìœ„í•œ ë°©ë²•ì„ ì•Œì•„ë³´ì
> 

âœ”ï¸Â **Page Tableì˜ êµ¬ì„±**

- **Page-table base register (PTBR)**

âœ”ï¸Â  **í˜ì´ì§€ í…Œì´ë¸”ë§Œ ìˆì—ˆì„ ë•Œ, ë¬¼ë¦¬ì  ë©”ëª¨ë¦¬ ì£¼ì†Œì— ë‹¿ê¸°ê¹Œì§€ 2ë²ˆì˜ ë©”ëª¨ë¦¬ ì ‘ê·¼ì´ í•„ìš”í•˜ë‹¤. ì²«ë²ˆì§¸ ì ‘ê·¼ì€ CPU â†’ Page Table ì ‘ê·¼ ë‘ë²ˆì§¸ ì ‘ê·¼ì€ Page Table â†’ Page frame ì ‘ê·¼ì´ë‹¤.** 

- Page-table base register (PTBR)ê°€ page tableì„ ê°€ë¦¬í‚´
    - ë©”ëª¨ë¦¬ì— ìƒì£¼í•˜ê³ ìˆëŠ” page tableì˜ ì‹œì‘ìœ„ì¹˜
- Page-table length register (PTLR)ê°€ í…Œì´ë¸” í¬ê¸°ë¥¼ ë³´ê´€
- ëª¨ë“  ë©”ëª¨ë¦¬ ì ‘ê·¼ ì—°ì‚°ì—ëŠ” 2ë²ˆì˜ memory acess í•„ìš”
    - page table ì ‘ê·¼ 1ë²ˆ, ì‹¤ì œ data/instruction ì ‘ê·¼ 1ë²ˆ
- translation look-aside buffer (associative register or TLB)
    - ì†ë„ í–¥ìƒì„ ìœ„í•´ ì‚¬ìš©ë˜ëŠ” ê³ ì† lookup hardwore cache
    - ë©”ëª¨ë¦¬ ì ‘ê·¼ ì—°ì‚°ì´ 2ë²ˆ ì´ë¤„ì§€ëŠ” ë¹„íš¨ìœ¨ì ì¸ ì ‘ê·¼ë°©ì‹ì„ ë³´ì™„í•¨
    - page tableì—ì„œ ì ‘ê·¼ì´ ìì£¼ ì´ë¤„ì§€ëŠ” ì—”íŠ¸ë¦¬ë¥¼ ìºì‹±í•˜ê³  ìˆìŒ
    - CPUê°€ ìºì‹±ë˜ì–´ìˆëŠ” í˜ì´ì§€ ì£¼ì†Œë¥¼ ì°¾ì„ ê²½ìš° CPU â†’ TLB â†’ Physical Memory
    - TLBì— ì¡´ì¬í•˜ì§€ ì•Šì„ ê²½ìš° CPU â†’  Page table(Physical Memory) â†’ Physical Memory
    - ë¬¼ë¦¬ì  í˜ì´ì§€ì™€ ë…¼ë¦¬ì  í˜ì´ì§€ ì£¼ì†Œì˜ ìŒìœ¼ë¡œ ì´ë¤„ì ¸ìˆìŒ

Associative registers(TLB) : ë³‘ë ¬ ê²€ìƒ‰ì´ ê°€ëŠ¥

- TLBì—ëŠ” page table ì¤‘ ì¼ë¶€ë§Œ ì¡´ì¬

Address translaction

- page table ì¤‘ ì¼ë¶€ê°€ associative registerì— ë³´ê´€ë˜ì–´ ìˆìŒ
- ë§Œì•½ í•´ë‹¹ pageê°€ associative registerì— ìˆëŠ” ê²½ìš° ê³§ë°”ë¡œ frame #ì„ ì–»ìŒ
- ê·¸ë ‡ì§€ ì•Šì€ ê²½ìš° main memoryì— ìˆëŠ” page tableë¡œ ë¶€í„° frame #ì„ ì–»ìŒ
- TLBëŠ” context switch ë•Œ flush (remove old entries)

### 1.3 Two-Level Page Table

> ì†ë„ëŠ” ëŠë ¤ì§€ë”ë¼ë„ í˜ì´ì§€ í…Œì´ë¸”ì˜ í¬ê¸°ë¥¼ ì¤„ì´ê¸° ìœ„í•œ ë°©ë²•ì´ë‹¤.
> 

> ì´ë‹¨ê³„ í…Œì´ë¸”ì—ì„œëŠ” page table ìì²´ë¥¼ pageë¡œ êµ¬ì„±í•œë‹¤.
> 

> page table ìì²´ë¥¼ pageë¡œ êµ¬ì„±
> 

> ì‚¬ìš©ë˜ì§€ ì•ŠëŠ” ì£¼ì†Œ ê³µê°„ì— ëŒ€í•œ outer page tableì˜ ì—”íŠ¸ë¦¬ ê°’ì€ null (ëŒ€ì‘í•˜ëŠ” inner page tableì´ ì—†ìŒ)
> 
- í˜„ëŒ€ì˜ ì»´í“¨í„°ëŠ” address spaceê°€ ë§¤ìš° í° í”„ë¡œê·¸ë¨ ì§€ì› (ìµœê·¼ì—ëŠ” 64bit êµ¬ì„±ë„ ë§ìŒ)
    - 32 bit address ì‚¬ìš© ì‹œ: 2ì˜ 32ìŠ¹ì˜ ì£¼ì†Œ ê³µê°„ì´ í•„ìš”í•˜ë‹¤ (4GB)
        - page sizeê°€ 4K ì‹œ 1Mê°œì˜ page table entry í•„ìš”
        - ê° page entryê°€ 4Bì‹œ í”„ë¡œì„¸ìŠ¤ë‹¹ 4Mì˜ page table í•„ìš”
        - ê·¸ëŸ¬ë‚˜, ëŒ€ë¶€ë¶„ì˜ í”„ë¡œê·¸ë¨ì€ 4Gì˜ ì£¼ì†Œ ê³µê°„ ì¤‘ ì§€ê·¹íˆ ì¼ë¶€ë¶„ë§Œ ì‚¬ìš©í•˜ë¯€ë¡œ page table ê³µê°„ì´ ì‹¬í•˜ê²Œ ë‚­ë¹„ëœë‹¤
        

ğŸŒŸÂ  ì´ë‹¨ê³„ í˜ì´ì§€ í…Œì´ë¸” ì˜ˆì‹œÂ 

âœ”ï¸Â Logical Address (on 32-bit machine with $K page size)ì˜ êµ¬ì„±

- 20 bitì˜ page number
- 12 bitì˜ page offset

âœ”ï¸Â Page table ìì²´ê°€ pageë¡œ êµ¬ì„±ë˜ê¸° ë•Œë¬¸ì— page NumberëŠ” ë‹¤ìŒê³¼ ê°™ì´ ë‚˜ë‰œë‹¤

(ê° page table entryê°€ 4B)

10 - bitì˜ page number

10 - bitì˜ page offset

ë”°ë¼ì„œ, logical addressëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-04-07 á„‹á…©á„’á…® 9 55 33](https://user-images.githubusercontent.com/56028408/162226691-ddf3845a-3807-44b6-bc68-92f05e7efb7b.png)

P1ì€ outer page tableì˜ indexì´ê³ 

P2ëŠ” outer page tableì˜ pageì—ì„œì˜ ë³€ì˜(displacement)

âœ”ï¸Â 2ë‹¨ê³„ í˜ì´ì§•ì—ì„œì˜ Address-translation scheme

![image](https://user-images.githubusercontent.com/56028408/162226209-7f026927-267b-4194-8b4e-cb4721f16f8a.png)

1. ë…¼ë¦¬ì  ì£¼ì†Œì—ì„œ outer table ì˜ index ë²ˆí˜¸ë¥¼ ì°¾ëŠ”ë‹¤.
2. outer tableì—ì„œ P1ê°’ì— ìœ„ì¹˜ë¡œ ì´ë™í•œ í›„ inner page table ì—”íŠ¸ë¦¬ì˜ ìœ„ì¹˜ ê°’ì„ ê°€ì ¸ì˜¨ë‹¤.
3. outertableì—ì„œ inner page tableë¡œ ì´ë™í•œë‹¤.
4. inner tableì—ì„œ P2ê°’ì— í•´ë‹¹í•˜ëŠ” ì—”íŠ¸ë¦¬ë¡œ ì´ë™í•œ í›„ ì €ì¥ëœ ë¬¼ë¦¬ì  í˜ì´ì§€ í”„ë ˆì„ ì£¼ì†Œë¥¼ ì–»ê²Œëœë‹¤.

inner tableì˜ í¬ê¸°ëŠ” 4KBë¡œ í˜ì´ì§€ì˜ í¬ê¸°ì™€ ë™ì¼í•˜ë‹¤.

ì´ë‹¨ê³„ í…Œì´ë¸”ì€ ì†ë„ëŠ” ëŠë¦¬ë”ë¼ë„ í˜ì´ì§€ í…Œì´ë¸”ì˜ ê³µê°„ì„ ì¤„ì´ëŠ” ê²ƒì´ ëª©ì ì¸ ë°˜ë©´ì— 

ì—¬ì „íˆ inner tableì˜ ì—”íŠ¸ë¦¬ëŠ” 100ë§Œê°œ ì´ìƒì´ í•„ìš”í•˜ë‹¤. ì¶”ê°€ì ìœ¼ë¡œ outer table ê³¼ inner tableë¡œ êµ¬ì„±ë˜ì–´ ìˆì–´ì„œ ê³µê°„ê³¼ ì‹œê°„ì´ ê¸°ì¡´ page tableì— ë¹„í•´ì„œ ë” ì†í•´ì´ë‹¤. 

í•˜ì§€ë§Œ ê·¸ëŸ¼ì—ë„ ì´ë‹¨ê³„ í…Œì´ë¸”ì„ ì‚¬ìš©í•˜ëŠ” ì´ìœ ëŠ” ?!

í”„ë¡œê·¸ë¨ì„ êµ¬ì„±í•˜ëŠ” ê³µê°„ì—ì„œ ì‚¬ìš©ë˜ëŠ” í˜ì´ì§€ì˜ ìˆ˜ëŠ” ì–¼ë§ˆ ì•ˆë˜ì§€ë§Œ í˜ì´ì§€ í…Œì´ë¸”ì€ ì‹¤ì œ ì‚¬ìš©í•˜ëŠ” í˜ì´ì§€ì˜ ìˆ˜ê°€ ì ë”ë¼ë„ ë…¼ë¦¬ì  ë©”ëª¨ë¦¬ì˜ ìµœëŒ€ í¬ê¸°ë§Œí¼ ì—”íŠ¸ë¦¬ë¥¼ ìƒì„±í•œë‹¤. ê·¸ëŸ°ë° ì´ë‹¨ê³„ í˜ì´ì§€ í…Œì´ë¸”ì€ outer page tableì€ ë…¼ë¦¬ì  ë©”ëª¨ë¦¬ í¬ê¸°ë§Œí¼ ìƒì„±í•˜ì§€ë§Œ ì‹¤ì œ ì‚¬ìš©ì´ ë˜ì§€ì•ŠëŠ” ì—”íŠ¸ë¦¬ëŠ” Nullë¡œ í• ë‹¹í•˜ê³  inner tableì˜ ì—”íŠ¸ë¦¬ë¥¼ ìƒì„±í•˜ì§€ ì•ŠëŠ”ë‹¤. 

ì‹¤ì œ í”„ë¡œê·¸ë¨ì€ í”„ë¡œê·¸ë¨ì´ ì‚¬ìš©ë˜ì§€ ì•Šë”ë¼ë„ 4KBì˜ ë©”ëª¨ë¦¬ ê³µê°„ì„ ì „ë¶€ ì±„ìš´ë‹¤. 

### 1.4 Multilevel Paging and Performance

> ì£¼ì†Œê³µê°„ì´ ë” ì»¤ì§€ë©´ ë‹¤ë‹¨ê³„ í˜ì´ì§€ í…Œì´ë¸”ì´ í•„ìš”í•˜ë‹¤ ë‹¤ë‹¨ê³„ í…Œì´ë¸”ì€ ë‹¨ê³„ë³„ë¡œ í˜ì´ì§€ í…Œì´ë¸”ì´ ë©”ëª¨ë¦¬ì— ì¡´ì¬í•˜ë¯€ë¡œ logical addressì˜ physical address ë³€í™˜ì— ë” ë§ì€ ë©”ëª¨ë¦¬ ì ‘ê·¼ì´ í•„ìš”í•˜ë‹¤ í•˜ì§€ë§Œ ì´ëŸ¬í•œ ë¬¸ì œì ì€ TLBë¥¼ í†µí•˜ì—¬ ì ‘ê·¼ì‹œê°„ì„ ì¤„ì¼ ìˆ˜ ìˆë‹¤.
> 

âœ”ï¸Â 4ë‹¨ê³„ í˜ì´ì§€ í…Œì´ë¸”ì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš°

- ë©”ëª¨ë¦¬ ì ‘ê·¼ ì‹œê°„ì´ 100ns, TLB ì ‘ê·¼ ì‹œê°„ì´ 20nsì´ê³ 
- TLB hit ratioê°€ 98%ì¸ ê²½ìš°
    - effective memory access time = 0.98 x 120 + 0.02 x 520 = 128 nanoseconds
        - ê²°ê³¼ì ìœ¼ë¡œ ì£¼ì†Œë³€í™˜ì„ ìœ„í•´ 28nsë§Œ ì†Œìš”í•œë‹¤.

### 1ï¸âƒ£Â  Memory Protection

> Page tableì˜ ê° entry ë§ˆë‹¤ ì•„ë˜ì˜ bitë¥¼ ë‘”ë‹¤.
> 

**âœ”ï¸Â Protection bit**

1. Pageì— ëŒ€í•œ ì ‘ê·¼ ê¶Œí•œ (read/write/read-only) 
    1. í˜ì´ì§€ í…Œì´ë¸”ì€ í”„ë¡œì„¸ìŠ¤ ë§ˆë‹¤ ê°ê° ìƒì„±ë˜ë¯€ë¡œ ë‹¤ë¥¸ í”„ë¡œì„¸ìŠ¤ê°€ Pageì— ì ‘ê·¼í•˜ëŠ” ê²ƒì„ ë§‰ê¸°ìœ„í•œ ê²ƒì´ ì•„ë‹ˆë¼ ì—°ì‚°ì— ëŒ€í•œ ì ‘ê·¼ ê¶Œí•œì„ ì˜ë¯¸í•œë‹¤
    2. ì˜ˆë¥¼ ë“¤ë©´ ì½”ë“œì˜ì—­ì€ ì‹¤í–‰ë„ì¤‘ ë³€ê²½ë˜ë©´ ì•ˆë˜ë¯€ë¡œ  read-only ê¶Œí•œì„ ë¶€ì—¬í•˜ê³  ë°ì´í„°ë‚˜ ìŠ¤íƒì˜ì—­ì—ëŠ” read, write ê¶Œí•œì„ ë¶€ì—¬í•œë‹¤.

âœ”ï¸Â **Valid (v) / Invalid (i) Bit in a Page Table**

1. valid-invalid bit
    - Valid (v)
        - Page 0ì„ ì˜ˆë¡œ ë“¤ë©´ Page 0ì´ ì‹¤ì œë¡œ 2ì˜ ì£¼ì†Œë¥¼ ê°€ì§„ Page frameì— í• ë‹¹ëœ ê²ƒì„ ì˜ë¯¸í•¨ (ì‹¤ì œë¡œ í˜ì´ì§€ê°€ ë¬¼ë¦¬ì  ë©”ëª¨ë¦¬ì— ì¡´ì¬í•œë‹¤)
    - Invalid (i)
        - í•´ë‹¹ ì£¼ì†Œì˜ frameì— ìœ íš¨í•œ ë‚´ìš©ì´ ì—†ì„ì„ ì˜ë¯¸í•œë‹¤ (ì ‘ê·¼ ë¶ˆí—ˆ)
            1. í”„ë¡œì„¸ìŠ¤ê°€ ê·¸ ì£¼ì†Œ ë¶€ë¶„ì„ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ê²½ìš°
            2. í•´ë‹¹ í˜ì´ì§€ê°€ ë©”ëª¨ë¦¬ì— ì˜¬ë¼ì™€ ìˆì§€ ì•Šê³  swap areaì— ìˆëŠ” ê²½ìš°

![257F2E3C5757C75D31 (1)](https://user-images.githubusercontent.com/56028408/162225826-33165124-98fc-409b-8174-0d0c05b8b653.jpeg)

### 1.4 Inverted Page Table (ì—­ë°©í–¥ í˜ì´ì§€ í…Œì´ë¸”)

> Page tableì€ ì‹¤í–‰ë˜ëŠ” í”„ë¡œì„¸ìŠ¤ë§ˆë‹¤ ë…ë¦½ì ìœ¼ë¡œ ìƒì„±ë˜ê¸° ë•Œë¬¸ì— ë©”ëª¨ë¦¬ë¥¼ ë§ì´ ì°¨ì§€í•œë‹¤. í•˜ì§€ë§Œ **Inverted Page Table**ì€ ê¸°ì¡´ Page tableê³¼ ë‹¤ë¥´ê²Œ ëª¨ë“  í”„ë¡œì„¸ìŠ¤ê°€ **Inverted Page Table**ì„ ì°¸ì¡°í•˜ê²Œ í•˜ëŠ” ë°©ì‹ì´ë‹¤. **Inverted Page Tableì€** Page Frame ê¸°ì¤€ìœ¼ë¡œ ì—”íŠ¸ë¦¬ë¥¼ ìƒì„±í•œë‹¤.
> 

ğŸ’¡Â Page tableì´ ë§¤ìš° í° ì´ìœ 

- ëª¨ë“  process ë³„ë¡œ ê·¸ logical addressì— ëŒ€ì‘í•˜ëŠ” ëª¨ë“  pageì— ëŒ€í•´ page table entryê°€ ì¡´ì¬
- ëŒ€ì‘í•˜ëŠ” pageê°€ ë©”ëª¨ë¦¬ì— ìˆë“  ì•„ë‹ˆë“  ê°„ì— page tableì—ëŠ” entryë¡œ ì¡´ì¬

âœ”ï¸Â **Inverted page table (ì—­ë°©í–¥ í˜ì´ì§€ í…Œì´ë¸”)**

- Page frame í•˜ë‚˜ë‹¹ page tableì— í•˜ë‚˜ì˜ entryë¥¼ ë‘” ê²ƒ (system-wide)
- ë©”ëª¨ë¦¬ ê³µê°„ì„ í™•ë³´í•˜ê¸° ìœ„í•´ ì‚¬ìš© ë¨
- ì—­ë°©í–¥ í˜ì´ì§€ í…Œì´ë¸”ì˜ ì—”íŠ¸ë¦¬ëŠ” ë…¼ë¦¬ì ì¸ í˜ì´ì§€ ë²ˆí˜¸ì™€ Pidë¥¼ ì €ì¥í•˜ê³  ìˆìŒ
- ë‹¨ì 
    - í…Œì´ë¸” ì „ì²´ë¥¼ íƒìƒ‰í•´ì•¼ í•¨
- ì¡°ì¹˜
    - associative register ì‚¬ìš© (expensive)

![image](https://user-images.githubusercontent.com/56028408/162448838-96f5d704-d018-488d-922f-d1fc7a285b12.png)

âœ”ï¸Â  **ì£¼ì†Œë³€í™˜ê³¼ì •**
- Page Tableì—ì„œ pidì™€ page numberë¡œ í•´ë‹¹ ì •ë³´ê°€ ì €ì¥ëœ ì—”íŠ¸ë¦¬ì˜ ìœ„ì¹˜ë¥¼ ì°¾ëŠ”ë‹¤
- ì°¾ì•„ì§„ ì—”íŠ¸ë¦¬ê°€ ëª‡ë²ˆì§¸ ìœ„ì¹˜ì— ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸í•˜ê³  í•´ë‹¹ ì£¼ì†Œì˜ í˜ì´ì§€ í”„ë ˆì„ì„ ì°¾ëŠ”ë‹¤.
- ê° page tavle entryëŠ” ê°ê°ì˜ ë¬¼ë¦¬ì  ë©”ëª¨ë¦¬ì˜ page frameì´ ë‹´ê³  ìˆëŠ” ë‚´ìš© í‘œì‹œ (process-id, processì˜ logical address)

### 1.5 Shard Page

âœ”ï¸Â **Shared code**

- Re-entrant Code (=Pure code)
    - read-onlyë¡œ í•˜ì—¬ í”„ë¡œì„¸ìŠ¤ ê°„ì— í•˜ë‚˜ì˜ codeë§Œ ë©”ëª¨ë¦¬ì— ì˜¬ë¦¼ (eg, text, editors, compliers, winodw, systems)
- Shared codeëŠ” ëª¨ë“  í”„ë¡œì„¸ìŠ¤ì˜ logical address spaceì—ì„œ ë™ì¼í•œ ìœ„ì¹˜ì— ìˆì–´ì•¼ í•¨ (ë™ì¼í•œ page numberë¥¼ ê°€ì ¸ì•¼í•¨)
- Private code and data
    - ê° í”„ë¡œì„¸ìŠ¤ë“¤ì€ ë…ìì ìœ¼ë¡œ ë©”ëª¨ë¦¬ì— ì˜¬ë¦¼
    - Private dataëŠ” logical address spaceì˜ ì•„ë¬´ ìœ„ì¹˜ì— í• ë‹¹ë˜ì–´ë„ ë¬´ë°©

![image](https://user-images.githubusercontent.com/56028408/162453156-7a30193b-5690-4a92-a534-37d952e26fd0.png)


**âœ”ï¸Â ì˜ˆë¥¼ ë“¤ë©´?** 

ì„œë¡œ ë‹¤ë¥¸ í”„ë¡œì„¸ìŠ¤ P1, P2, P3ê°€ ë™ì¼í•œ ì½”ë“œë¥¼ ì‚¬ìš©í•˜ë‹¤ë©´ ì½”ë“œë¥¼ í”„ë¡œì„¸ìŠ¤ë§ˆë‹¤ ê°ê° ì˜¬ë¦¬ëŠ” ê²ƒì€ ë¹„íš¨ìœ¨ ì ì´ë‹¤.  ì¦‰ ê³µìœ í•  ìˆ˜ ìˆëŠ” ì½”ë“œëŠ” ë³„ë„ë¡œ ì˜¬ë¦¬ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ê°™ì€ Frameìœ¼ë¡œ ë§¤í•‘í•˜ì—¬ í•œì¹¸ì˜ Page Frame ë§Œì„ í• ë‹¹í•˜ëŠ” ê²ƒì´ íš¨ìœ¨ì ì´ë¼ê³  í•  ìˆ˜ ìˆë‹¤. í•˜ì§€ë§Œ ëª¨ë“  í”„ë¡œì„¸ìŠ¤ê°€ ê°™ì€ ì½”ë“œì˜ì—­ì„ ì°¸ì¡°í•˜ê³  ìˆê¸° ë•Œë¬¸ì— ê³µìœ í•˜ëŠ” ì½”ë“œì˜ì—­ì€ read-onlyë¡œ ì„¤ì •í•´ì•¼í•œë‹¤. ê·¸ë¦¬ê³  ê³µìœ ì½”ë“œëŠ” í”„ë¡œì„¸ìŠ¤ê°€ ë‹¤ë¥´ë”ë¼ë„ ë™ì¼í•œ logical addressë¥¼ ê°€ì ¸ì•¼í•œë‹¤.

## 2. Segmentation

> í”„ë¡œê·¸ë¨ì€ ì˜ë¯¸ ë‹¨ìœ„ì¸ ì—¬ëŸ¬ ê°œì˜ segmentë¡œ êµ¬ì„±
> 
> - ì‘ê²ŒëŠ” í”„ë¡œê·¸ë¨ì„ êµ¬ì„±í•˜ëŠ” í•¨ìˆ˜ í•˜ë‚˜í•˜ë‚˜ë¥¼ ì„¸ê·¸ë¨¼íŠ¸ë¡œ ì •ì˜
> - í¬ê²ŒëŠ” í”„ë¡œê·¸ë¨ ì „ì²´ë¥¼ í•˜ë‚˜ì˜ ì„¸ê·¸ë¨¼íŠ¸ë¡œ ì •ì˜ ê°€ëŠ¥
> - ì¼ë°˜ì ìœ¼ë¡œëŠ” code,data,stack ë¶€ë¶„ì´ í•˜ë‚˜ì”©ì˜ ì„¸ê·¸ë¨¼íŠ¸ë¡œ ì •ì˜ë¨
> 
> Paging ë°©ì‹ì²˜ëŸ¼ ë™ì¼í•œ í¬ê¸°ë¡œ ë¶„í• í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ë™ì  ë©”ëª¨ë¦¬ í• ë‹¹ ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤.
> 

âœ”ï¸Â **SegmentëŠ” ë‹¤ìŒê³¼ ê°™ì€ logical unit ë“¤**

- main()
- function
- global variables
- stack
- symbol table, arrays

### 2.1 Segmentation Architecture

âœ”ï¸Â  Logical address êµ¬ì„±

- segment-number, offset

âœ”ï¸Â Segment table

- each table entry has:
    - base - starting physical address of the segment
    - limit - length of ther segment

âœ”ï¸Â Segment-table base register (STBR)

- ë¬¼ë¦¬ì  ë©”ëª¨ë¦¬ì—ì„œì˜ segment tableì˜ ìœ„ì¹˜

âœ”ï¸Â Segment-table length register (STLR)

- í”„ë¡œê·¸ë¨ì´ ì‚¬ìš©í•˜ëŠ” segmentì˜ ìˆ˜
    - segment numberì˜ í¬ê¸°ëŠ” STLRì˜ ë²”ìœ„ë¥¼ ë„˜ì–´ì„œë©´ ì•ˆë¨

![image](https://user-images.githubusercontent.com/56028408/162457379-518ac837-ad86-4c43-81e5-5d4980bfc828.png)

**âœ”ï¸Â Segmentationì˜ ì£¼ì†Œë³€í™˜**

1. ë…¼ë¦¬ì£¼ì†Œì˜ SegmentNumberê°€ STLRë³´ë‹¤ ì‘ì€ ê°’ì¸ì§€ í™•ì¸í•˜ê³  ë§Œì•½ ë” í° ê°’ì„ ìš”ì²­í–ˆë‹¤ë©´ trapì„ ë°œìƒì‹œí‚¨ë‹¤.
2. ê°’ì´ STLR ë²”ìœ„ì— í¬í•¨ë  ê²½ìš° offsetì˜ ê°’ì´ segmentì˜ ë©”ëª¨ë¦¬ ë²”ìœ„ì•ˆì— í¬í•¨ë˜ëŠ” ì§€ í™•ì¸í•œë‹¤
3.  í¬í•¨ë˜ëŠ” ê°’ì´ë©´ Segment ì‹œì‘ìœ„ì¹˜ì™€ Offsetì„ ë”í•´, ë¬¼ë¦¬ì  ë©”ëª¨ë¦¬ ì£¼ì†Œì˜ ìœ„ì¹˜ë¥¼ ì°¾ëŠ”ë‹¤.

# ì‘ì„± and ì •ë¦¬ ì£¼ì›… !!!!
